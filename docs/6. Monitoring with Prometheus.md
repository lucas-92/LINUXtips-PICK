Installing Kube Prometheus

Kube Prometheus is distributed by the Prometheus Operator community. You can install it using the manifests available in the Prometheus Operator repository.

Clone the repository:
```
git clone https://github.com/prometheus-operator/kube-prometheus.git
cd kube-prometheus
```

Apply the namespace creation manifests and CRDs:
```
kubectl create -f manifests/setup
```

Wait until the CRDs are ready by checking their status:
```
kubectl get crds
```

Then, apply the rest of the manifests to install Prometheus, Grafana and Alertmanager:
```
kubectl create -f manifests/
```

Check the exposed services:
```
kubectl get svc -n monitoring
```

Exposing Grafana and Prometheus with Ingress Controller

Install Ingress Controller
```
kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/kind/deploy.yaml
```

Check if the ingress controller related pods are running in the ingress-nginx namespace:
```
kubectl get pods -n ingress-nginx
```

Configure Ingress

Once Ingress Controller is installed, you will need to create an Ingress resource that will define traffic routing rules for Prometheus and Grafana. Create the ingress.yaml file as shown in the example below:
```
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: monitoring-ingress
  namespace: monitoring
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  ingressClassName: nginx
  rules:
  - host: localhost
    http:
      paths:
      - path: /prometheus
        pathType: Prefix
        backend:
          service:
            name: prometheus-k8s
            port:
              number: 9090
      - path: /grafana
        pathType: Prefix
        backend:
          service:
            name: grafana
            port:
              number: 3000
```
This Ingress file does:
- /prometheus will route traffic to the Prometheus service.
- /grafana will route traffic to the Grafana service.

Apply the Ingress file using the command:
```
kubectl apply -f ingress.yaml
```

Verify that Ingress has been correctly configured using:
```
kubectl get ingress -n monitoring
```

Describe the Ingress:
```
kubectl describe ingress monitoring-ingress -n monitoring
```
